name,"['Table input work_alterian_indv_auth_table', 'Text file output, indvauth', 'Get Data from ccpa', 'Copy rows to result', 'Replace in string', 'ccpa python input', 'ccpa python output', 'Get rows from result', 'Get Variables', 'Copy rows to result', 'Write to log', 'get individual_sks for email address', 'Copy rows to result', 'Get Data from source xref', 'Write to log', 'Copy rows to result', 'Get Data from ccpa', 'Write to log', 'Text file output, ccpa json resposnse', 'table input CCPS data', 'Text file output, ccpa json resposnse', 'table input CCPA status', 'Copy rows to result', 'Get Data from ccpa', 'Write to log', 'Get rows from result', 'Set Variables', 'Get rows from result', 'Set Variables', 'Get Rows from results', 'Set Variables', 'Get Rows from results', 'Set Variables', 'Get rows from result', 'Set Variables', 'status_switch', 'case DNS', 'case DELETE', 'Execute SQL script']","
",type,"['TableInput', 'TextFileOutput', 'TableInput', 'RowsToResult', 'ReplaceString', 'TextFileInput', 'TextFileOutput', 'RowsFromResult', 'GetVariable', 'RowsToResult', 'WriteToLog', 'TableInput', 'RowsToResult', 'TableInput', 'WriteToLog', 'RowsToResult', 'TableInput', 'WriteToLog', 'TextFileOutput', 'TableInput', 'TextFileOutput', 'TableInput', 'RowsToResult', 'TableInput', 'WriteToLog', 'RowsFromResult', 'SetVariable', 'RowsFromResult', 'SetVariable', 'RowsFromResult', 'SetVariable', 'RowsFromResult', 'SetVariable', 'RowsFromResult', 'SetVariable', 'SwitchCase', 'SwitchCase', 'SwitchCase', 'ExecSQL']","
",sql,"[""select individual_sk,\r\n       max(case when authorization_cd_sk = 171 then 'Y' else 'N' end) as pand_glb,\r\n       max(case when authorization_cd_sk = 1720 then 'Y' else 'N' end) as pand_hrt,\r\n\t   max(case when authorization_cd_sk = 17100 then 'Y' else 'N' end) as pand_hst,      \r\n\t   max(case when authorization_cd_sk = 15 then 'Y' else 'N' end) as dma_mail,\t\t \r\n\t   max(case when authorization_cd_sk = 19 then 'Y' else 'N' end) as prison,\t\r\n\t   max(case when authorization_cd_sk = 16 then 'Y' else 'N' end) as panccc,\r\n       max(case when authorization_cd_sk = 26 then 'Y' else 'N' end) as rent,\r\n\t   max(case when authorization_cd_sk = 27 then 'Y' else 'N' end) as rent_int,\r\n       max(case when authorization_cd_sk = 31 then 'Y' else 'N' end) as trn_email,\r\n\t   max(authorization_effective_dt) as authorization_effective_dt,\r\n       NOW() as load_dt\t\r\n\t\t\t\t  \t\t \r\nfrom work_alterian_indv_auth_table \r\n\r\n\r\ngroup by individual_sk; "", None, ""-- Below query is for regular data from work_email_promotion_hist_f_stg_agg_deduped\r\n\r\nSELECT `ccpa_seq_nbr`,\r\n\t`ccpa_request_id`,\r\n\t`ccpa_request_type`,\r\n\t`ccpa_request_source`,\r\n\t`ccpa_publisher_code`,\r\n\t`ccpa_request_brand`,\r\n\t`ccpa_acct_nbr`,\r\n\t`ccpa_email_addr`,\r\n\t`ccpa_request_date`\r\nFROM hrst_stg.`a_a_ccpa_input` a\r\nWHERE a.`ccpa_request_status` = 'WIP';"", None, None, None, None, None, None, None, None, ""-- Below query is for regular data from work_email_promotion_hist_f_stg_agg_deduped\r\n\r\n\t\t\t\t\t\t\r\nSELECT GROUP_CONCAT(e.individual_sk SEPARATOR ',') as individual_sks ,\r\ncount(*) as num_found\r\nFROM hrst.`wt_email_d` e1 \r\nJOIN hrst.`wt_email_individual_bridge` e ON e.`email_sk` = e1.`email_sk`\r\nWHERE e1.email_address = '${CCPA_EMAIL_ADDR}';"", None, ""-- Below query is for regular data from work_email_promotion_hist_f_stg_agg_deduped\r\n\r\n\t\t\t\t\t\t\r\nSELECT d.individual_sk FROM hrst.`wt_individual_d` d \r\ninner join  hrst_stg.`source_xref_stg` sx on d.`universal_id`=  sx.universal_id  \r\nwhere sx.`system_code` = '${CCPA_REQUEST_SOURCE}'\r\n\t\t\t\t\t\t\tAND sx.`publisher_code` = '${CCPA_PUBLISHER_CODE}'\r\n\t\t\t\t\t\t\tAND sx.`system_id` = ${CCPA_ACCT_NBR}\r\n\t\t\t\t\t\t\tAND d.`curr_rec_ind` = 1\r\nunion\r\nSELECT d.individual_sk FROM hrst.`wt_individual_d` d \r\ninner join  hrst_stg.`source_xref_stg` sx on d.`universal_id`=  sx.universal_id  \r\nwhere sx.`system_code` = '${CCPA_REQUEST_SOURCE}'\r\n\t\t\t\t\t\t\tAND sx.`publisher_code` = '${CCPA_PUBLISHER_CODE}'\r\n\t\t\t\t\t\t\tAND sx.`system_id` = ${CCPA_ACCT_NBR}\r\nlimit 1;\t"", None, None, ""-- Below query is for regular data from work_email_promotion_hist_f_stg_agg_deduped\r\n\r\nSELECT `ccpa_seq_nbr`,\r\n\t`ccpa_request_id`,\r\n\t`ccpa_request_type`,\r\n\t`ccpa_request_source`,\r\n\t`ccpa_publisher_code`,\r\n\t`ccpa_request_brand`,\r\n\tLEFT(`ccpa_acct_nbr`, LENGTH(`ccpa_acct_nbr`) - 1) AS ccpa_acct_nbr,\r\n\t`ccpa_email_addr`,\r\n\t`ccpa_request_date`\r\nFROM hrst_stg.`a_a_ccpa_input` a\r\nWHERE a.`ccpa_request_status` = 'WIP'\r\nlimit 1000;"", None, None, '\tSELECT \r\n\tCONCAT(""{""""ccpa"""":{ """"referenceId"""":""""${CCPA_REQUEST_ID}"""", """"Customers"""": ["", \r\n\t\t(CASE WHEN c.`customer` IS NULL THEN \' \' ELSE c.`customer` END), \r\n\t\t""], """"Emails"""": ["", (CASE WHEN e.email IS NULL THEN \' \' ELSE e.email END) ,\r\n\t\t""], """"emailPromSum"""": ["", (CASE WHEN e2.email_prom_sum IS NULL THEN \' \' ELSE e2.email_prom_sum END) ,\r\n\t\t""], """"Eeditions"""": ["", (CASE WHEN f.`eeditions` IS NULL THEN \' \' ELSE f.`eeditions` END) ,\r\n\t\t""], """"Surveys"""": ["", (CASE WHEN s.`survey` IS NULL THEN \' \' ELSE s.`survey` END),\r\n\t\t""], """"pcUsers"""": ["", (CASE WHEN u.`user` IS NULL THEN \' \' ELSE u.`user` END),\r\n\t\t""], """"Newsletters"""": ["", (CASE WHEN n.newsletter IS NULL THEN \' \' ELSE n.newsletter  END),\r\n\t\t""], """"Demos"""": ["", (CASE WHEN a.`demos` IS NULL THEN \' \' ELSE a.`demos` END),\r\n\t\t""], """"retiredDemos"""": ["", (CASE WHEN b.`retired_demo` IS NULL THEN \' \' ELSE b.`retired_demo` END),\r\n\t\t""]} } "") AS json_file\r\nFROM \r\n\thrst_stg.`a_customer_group` c, \r\n\thrst_stg.`a_demo_group` a, \r\n\thrst_stg.`a_retired_demo_group` b,\r\n\thrst_stg.`a_email_group` e,\r\n\thrst_stg.`a_email_prom_sum_group` e2,\r\n\thrst_stg.`a_eeditions_group` f,\r\n\thrst_stg.`a_customer_survey_group` s,\r\n\thrst_stg.`a_pc_user_group` u,\r\n\thrst_stg.`a_newsletters_group` n;', None, 'SELECT\r\nCONCAT(""{""""ccpa"""":{ """"referenceid"""":"""""", a.`ccpa_request_id`, """""",""""referencestatus"""":"""""", a.`ccpa_request_status`, """"""} }"") AS json_file\r\nFROM   hrst_stg.`a_a_ccpa_input` a\r\nWHERE a.ccpa_seq_nbr = ${CCPA_SEQ_NBR};  \r\n\r\n\r\n', None, '-- Below query is for regular data from work_email_promotion_hist_f_stg_agg_deduped\r\n\r\nSELECT \r\n\t`ccpa_request_id` as p1,\r\n\t`ccpa_request_status` as p2,\r\n\t`update_dt`as p3,\r\n\t`ccpa_request_id` as p4\r\nFROM hrst_stg.`a_a_ccpa_input` a\r\nWHERE a.`ccpa_seq_nbr` =  ${CCPA_SEQ_NBR};', None, None, None, None, None, None, None, None, None, None, None, None, None, None, ""UPDATE hrst_stg.`a_a_ccpa_input` a\r\nSET a.`ccpa_request_status` = 'MADEIT'\r\nWHERE a.ccpa_seq_nbr = ${CCPA_SEQ_NBR}""]","
",from,"[['Table input work_alterian_indv_auth_table'], ['Get Data from ccpa'], ['ccpa python input'], ['Replace in string'], ['Get rows from result'], ['get individual_sks for email address'], ['Write to log'], ['Get Data from source xref'], ['Write to log'], ['Get Data from ccpa'], ['Write to log'], ['table input CCPS data'], ['table input CCPA status'], ['Get Data from ccpa'], ['Write to log'], ['Get rows from result'], ['Get rows from result'], ['Get Rows from results'], ['Get Rows from results'], ['Get rows from result'], ['status_switch'], ['status_switch'], ['status_switch']]","
",to,"[['Text file output, indvauth'], ['Copy rows to result'], ['Replace in string'], ['ccpa python output'], ['Get Variables'], ['Write to log'], ['Copy rows to result'], ['Write to log'], ['Copy rows to result'], ['Write to log'], ['Copy rows to result'], ['Text file output, ccpa json resposnse'], ['Text file output, ccpa json resposnse'], ['Write to log'], ['Copy rows to result'], ['Set Variables'], ['Set Variables'], ['Set Variables'], ['Set Variables'], ['Set Variables'], ['case DNS'], ['Execute SQL script'], ['case DELETE']]","
"
name in Step:,"[<_elementtree._element_iterator object at 0x0000025433FDE570>, <_elementtree._element_iterator object at 0x0000025433FDE700>]","
",filemask in Step:,"['${mdb.output.path}/${database}/alterian/insert_update/hold/indvauth_', '${marketingdb_dir_path}\\jobs\\ccpa\\test_formatted_2.py', None, '${marketingdb_dir_path}\\jobs\\ccpa\\test_formatted_full', '${mdb.output.path}/${database}/ccpa/${CCPA_REQUEST_ID}', '${mdb.output.path}/${database}/ccpa/${CCPA_REQUEST_ID}']","
"
